# Toolkit Backend Variables
env = GDK_BACKEND,wayland,x11
env = SDL_VIDEODRIVER,wayland
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland
env = QT_AUTO_SCREEN_SCALE_FACTOR,1
env = QT_QPA_PLATFORM,wayland;xcb
env = QT_QPA_PLATFORMTHEME,qt5ct
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1
env = GTK_THEME,Nordic

# Autostart
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment DISPLAY
exec-once = /usr/bin/lxqt-policykit-agent
exec-once = ~/.swaybg
exec-once = dunst
exec-once = battery
exec-once = fcitx5 -d
# exec-once = ~/.local/bin/portal
exec-once = dotoold &
exec-once = hyprctl setcursor Nordzy-cursors 24
# exec-once = wl-paste --watch cliphist store
exec-once = clipse -listen

# Configs

input {
    kb_layout = us
    kb_variant =
    kb_model =
    # kb_options = caps:swapescape
    kb_options =
    kb_rules = 

    follow_mouse = 2

    touchpad {
        natural_scroll = yes
    }

    repeat_rate = 50
    repeat_delay = 300
}

device {
    name = genius-wireless-mouse
    sensitivity = -0.4
}

gestures {
    workspace_swipe = true
    workspace_swipe_forever = true
}

general {
    gaps_in = 6
    gaps_out = 12
    border_size = 2
    col.active_border = rgb(5e81ac) rgb(88C0D0) 45deg
    col.inactive_border = rgb(3b4252)
    layout = master
    no_cursor_warps = true
    resize_corner = 3
}

decoration {
    rounding = 3
    drop_shadow = no
    dim_special = 0
    blur {
        enabled = true
        size = 3
        passes = 1
        new_optimizations = true
        special = false
    }
}

group {
    insert_after_current = false
    col.border_active = rgb(5e81ac) rgb(88C0D0) 45deg
    col.border_inactive = rgb(3b3252)
    groupbar {
        height = 1
        gradients = false
        render_titles = false
        col.active = rgb(5e81ac)
        col.inactive = rgb(3b3252)
    }
}

animations {
    enabled = yes

    animation = windows, 1, 2, default, slide
    animation = border, 1, 8, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 1, default
    animation = workspaces, 1, 1, default, slide
}

master {
    new_is_master = false
    mfact = 0.5
    allow_small_split = true
    special_scale_factor = 1
    inherit_fullscreen = false
}

binds {
    allow_workspace_cycles = true
}

misc {
    enable_swallow = true
    swallow_regex = ^(foot)$
    disable_autoreload = true
    disable_hyprland_logo = true
    close_special_on_empty = true
    background_color = rgb(2e3440)
    animate_manual_resizes = true
    initial_workspace_tracking = false
    vfr = true
}

$mod = SUPER
$term = foot

# Exit/close/reload
bind = $mod SHIFT, C, killactive
bind = $mod, F5, exec, hyprctl reload
bind = CONTROL ALT, BACKSPACE, exit

# Applications
bind = $mod SHIFT, RETURN, exec, $term
bind = $mod SHIFT, E,      exec, $term -e nnn
bind = $mod, B,            exec, qutebrowser
bind = $mod, N,            exec, qutebrowser --target private-window
bind = $mod SHIFT, B,      exec, firefox
bind = $mod SHIFT, N,      exec, firefox --private-window
bind = $mod, r,            exec, $(tofi-run --fuzzy-match true --require-match false --prompt-text "")
bind = $mod CTRL, r,       exec, tofi-drun --require-match false --prompt-text "" --drun-launch true
bind = $mod, F2,           exec, swaylock -i "$(cut -d' ' -s -f5 ~/.swaybg)"
bind = $mod, F6,           exec, wl-screenrec -o eDP-1 -f ~/Videos/captures/rec-$(date +'%Y-%m-%d_%H-%M-%S.mp4') --audio ; notify-send "Recording stopped"
bind = $mod SHIFT, F6,     exec, wl-screenrec -g "$(slurp)" -f ~/Videos/captures/rec-$(date +'%Y-%m-%d_%H-%M-%S.mp4') --audio ; notify-send "Recording stopped"
bind = $mod CTRL, F6,      exec, killall -s SIGINT wl-screenrec

bind = $mod, f9, submap, lock
submap = lock
bind = $mod, f9, submap, reset
submap = reset

bind = $mod, p, submap, programs
submap = programs

bind = , d, exec, vesktop
bind = , f, exec, pcmanfm
bind = , m, exec, prismlauncher
bind = , n, exec, ninjabrain
bind = , o, exec, obs
bind = , p, exec, $term pulsemixer
bind = , q, exec, qpwgraph
bind = , s, exec, steam-native
bind = , t, exec, pinta
bind = , z, exec, zathura

bind = , d, submap, reset
bind = , f, submap, reset
bind = , m, submap, reset
bind = , n, submap, reset
bind = , o, submap, reset
bind = , p, submap, reset
bind = , q, submap, reset
bind = , s, submap, reset
bind = , t, submap, reset
bind = , z, submap, reset
bind = , escape, submap, reset
submap = reset

# Tofi scripts
bind = $mod SHIFT, m, submap, tofi
submap = tofi

bind = , c, exec, tofi-colors
bind = , d, exec, tofi-draw
bind = , e, exec, tofi-unicode
bind = , k, exec, tofi-kaomoji
bind = , m, exec, tofi-mount
bind = , n, exec, tofi-poornitro
bind = , o, exec, tofi-quickmark
bind = , p, exec, tofi-power
bind = , u, exec, tofi-umount

bind = , c, submap, reset
bind = , d, submap, reset
bind = , e, submap, reset
bind = , k, submap, reset
bind = , m, submap, reset
bind = , n, submap, reset
bind = , o, submap, reset
bind = , p, submap, reset
bind = , u, submap, reset
bind = , escape, submap, reset
submap = reset

# Monitors
bind = $mod,       comma,  focusmonitor, +1
bind = $mod,       period, focusmonitor, -1
bind = $mod SHIFT, comma,  movewindow, mon:+1
bind = $mod SHIFT, period, movewindow, mon:-1
bind = $mod CTRL,  comma,  swapactiveworkspaces, current +1
bind = $mod CTRL,  period, swapactiveworkspaces, current -1

# Fullscreen
bind = $mod SHIFT, F, fullscreen, 0
bind = $mod CONTROL, F, fakefullscreen

# Master layout control
bind = $mod, h, movefocus, l
bind = $mod, j, movefocus, d
bind = $mod, k, movefocus, u
bind = $mod, l, movefocus, r
bind = ALT, TAB, cyclenext
bind = $mod SHIFT, H, layoutmsg, addmaster
bind = $mod SHIFT, J, layoutmsg, swapnext
bind = $mod SHIFT, K, layoutmsg, swapprev
bind = $mod SHIFT, L, layoutmsg, removemaster
bind = $mod, RETURN, layoutmsg, swapwithmaster

# Window Control
bind = $mod SHIFT, SPACE, togglefloating, 
binde = $mod CONTROL,           j, moveactive, 0 25
binde = $mod CONTROL,           k, moveactive, 0 -25
binde = $mod CONTROL,           l, moveactive, 25 0
binde = $mod CONTROL,           h, moveactive, -25 0
binde = $mod ALT CONTROL,       j, moveactive, 0 1
binde = $mod ALT CONTROL,       k, moveactive, 0 -1
binde = $mod ALT CONTROL,       l, moveactive, 1 0
binde = $mod ALT CONTROL,       h, moveactive, -1 0
binde = $mod CONTROL SHIFT,     j, resizeactive, 0 25
binde = $mod CONTROL SHIFT,     k, resizeactive, 0 -25
binde = $mod CONTROL SHIFT,     l, resizeactive, 25 0
binde = $mod CONTROL SHIFT,     h, resizeactive, -25 0
binde = $mod ALT SHIFT,         k, resizeactive, 0 -1
binde = $mod ALT SHIFT,         j, resizeactive, 0 1
binde = $mod ALT SHIFT,         l, resizeactive, 1 0
binde = $mod ALT SHIFT,         h, resizeactive, -1 0
binde = $mod CONTROL ALT SHIFT, j, resizeactive, 0 372
binde = $mod CONTROL ALT SHIFT, k, resizeactive, 0 -372
binde = $mod CONTROL ALT SHIFT, l, resizeactive, 372 0
binde = $mod CONTROL ALT SHIFT, h, resizeactive, -372 0
bind = $mod, F7, resizeactive, exact 100% 16384
bind = $mod, F7, centerwindow

# Groups
bind = $mod SHIFT, A, togglegroup
bind = $mod,       code:34, changegroupactive, b
bind = $mod,       code:35, changegroupactive, f
bind = $mod SHIFT, code:34, moveintogroup, u
bind = $mod SHIFT, code:34, moveintogroup, l
bind = $mod SHIFT, code:35, moveoutofgroup

# Workspace switching
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, d, workspace, 5
bind = $mod, z, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, TAB, workspace, previous

# Workspace moving
bind = $mod SHIFT, 1, movetoworkspace, 1
bind = $mod SHIFT, 2, movetoworkspace, 2
bind = $mod SHIFT, 3, movetoworkspace, 3
bind = $mod SHIFT, 4, movetoworkspace, 4
bind = $mod SHIFT, d, movetoworkspace, 5
bind = $mod SHIFT, z, movetoworkspace, 6
bind = $mod SHIFT, 7, movetoworkspace, 7
bind = $mod SHIFT, 8, movetoworkspace, 8
bind = $mod SHIFT, 9, movetoworkspace, 9
bind = $mod SHIFT, 0, pin,

# Scroll through existing workspaces
bind = $mod, mouse_down, workspace, r-1
bind = $mod, mouse_up, workspace, r+1

# Move/resize windows using mouse
bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow

# Zoom
bind = $mod,       equal, exec, hyprctl keyword misc:cursor_zoom_factor "$(hyprctl getoption misc:cursor_zoom_factor | grep float | awk '{print $2 + 1}')"
bind = $mod,       minus, exec, hyprctl keyword misc:cursor_zoom_factor "$(hyprctl getoption misc:cursor_zoom_factor | grep float | awk '{print $2 - 1}')"
bind = $mod SHIFT, equal, exec, hyprctl keyword misc:cursor_zoom_factor 1.0

# Toggle stuff
bind = $mod SHIFT, g,   exec, ~/.config/hypr/pretty
bind = $mod CONTROL, g, exec, ~/.config/hypr/animate
# bind = $mod, S,         exec, swaync-client -t -sw
bind = $mod, F1,        exec, killall -SIGUSR1 waybar
bind = $mod SHIFT, F1,  exec, killall waybar || waybar &
bind = $mod SHIFT, F4,  exec, killall yambar
bind = $mod, F4,        exec, yambar &
bind = $mod, F3,        exec, ~/.config/hypr/swallow
bind = $mod, f,         exec, hyprctl setprop address:$(hyprctl activewindow -j | jq '.address' -r) forcergbx 0 lock
bindr = $mod, f,        exec, hyprctl setprop address:$(hyprctl activewindow -j | jq '.address' -r) forcergbx 1 lock
bind = $mod, g,         exec, hyprctl setprop address:$(hyprctl activewindow -j | jq '.address' -r) alpha 1 lock
bind = $mod, g,         exec, hyprctl setprop address:$(hyprctl activewindow -j | jq '.address' -r) alphainactive 1 lock
bindr = $mod, g,        exec, hyprctl setprop address:$(hyprctl activewindow -j | jq '.address' -r) alpha 0.85 lock
bindr = $mod, g,        exec, hyprctl setprop address:$(hyprctl activewindow -j | jq '.address' -r) alphainactive 0.85 lock

# Audio
bind = ,         XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 1%-  ; notifyvolume
bind = SHIFT,    XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 10%- ; notifyvolume
bind = $mod,     XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 0%   ; notifyvolume
bind = ,         XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 1%+  ; notifyvolume
bind = SHIFT,    XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 10%+ ; notifyvolume
bind = $mod,     XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 100% ; notifyvolume
bind = , XF86AudioMute, exec, pactl set-sink-mute 0 toggle
bind = , XF86AudioPrev, exec, playerctl previous
bind = , XF86AudioNext, exec, playerctl next
bind = , XF86AudioPlay, exec, playerctl play-pause
bind = , XF86AudioStop, exec, playerctl stop

# Brightness
bind = ,         XF86MonBrightnessDown, exec, brightnessctl s 1%-  ; notifybrightness
bind = SHIFT,    XF86MonBrightnessDown, exec, brightnessctl s 10%- ; notifybrightness
bind = $mod,     XF86MonBrightnessDown, exec, brightnessctl s 0%   ; notifybrightness
bind = ,         XF86MonBrightnessUp,   exec, brightnessctl s +1%  ; notifybrightness
bind = SHIFT,    XF86MonBrightnessUp,   exec, brightnessctl s +10% ; notifybrightness
bind = $mod,     XF86MonBrightnessUp,   exec, brightnessctl s 100% ; notifybrightness

# Screenshots
bind = $mod SHIFT, S,             exec, screenshot s
bind = $mod CONTROL, S,           exec, screenshot f
bind = $mod ALT SHIFT, S,         exec, screenshot ss
bind = $mod ALT CONTROL, S,       exec, screenshot fs
bind = $mod CONTROL SHIFT, S,     exec, screenshot ds
bind = $mod ALT CONTROL SHIFT, S, exec, screenshot df

# Clipboard
# bind = $mod CTRL, v, exec, tofi-cliphist
bind = $mod CTRL, v, exec, [float] $term clipse

# Global Hotkeys
bind = , Alt_R, pass, ^(discord)$
bind = $mod, MENU, pass, ^(discord)$

# Monitors
monitor = , preferred, auto, 1
workspace = 1, monitor:eDP-1
workspace = 2, monitor:eDP-1
workspace = 3, monitor:eDP-1
workspace = 4, monitor:HDMI-A-1
workspace = 5, monitor:HDMI-A-1
workspace = 6, monitor:HDMI-A-1

# Window Rules
windowrule = workspace 4 silent, discord
windowrule = workspace 4 silent, vesktop
windowrulev2 = float,class:^(xwaylandvideobridge)$
windowrulev2 = pin,class:^(xwaylandvideobridge)$
windowrulev2 = opacity 0.0 override 0.0 override,class:^(xwaylandvideobridge)$
windowrulev2 = noanim,class:^(xwaylandvideobridge)$
windowrulev2 = nofocus,class:^(xwaylandvideobridge)$
windowrulev2 = noinitialfocus,class:^(xwaylandvideobridge)$
windowrulev2 = keepaspectratio,class:^(mpv)$
windowrulev2 = stayfocused, title:^()$,class:^(steam)$
windowrulev2 = minsize 1 1, title:^()$,class:^(steam)$
windowrulev2 = float,class:^(lxqt-policykit-agent)$

# Special Workspaces
$sgv = 173
$sgh = 305
workspace = special:any,   gapsout:$sgv $sgh
workspace = special:term,  on-created-empty:$term,gapsout:$sgv $sgh
workspace = special:notes, on-created-empty:$term nvim -O ~/Documents/vimwiki/*.md,gapsout:$sgv $sgh
workspace = special:fm,    on-created-empty:$term nnn,gapsout:$sgv $sgh
workspace = special:music, on-created-empty:$term cmus,gapsout:$sgv $sgh
workspace = special:mail,  on-created-empty:$term neomutt,gapsout:$sgv $sgh
workspace = special:jpdb,  on-created-empty:[stayfocused;float;move 1453 37;size 453 1029] qutebrowser jpdb.io/learn

bind = $mod, a,     togglespecialworkspace, term
bind = $mod, w,     togglespecialworkspace, notes
bind = $mod, e,     togglespecialworkspace, fm
bind = $mod, grave, togglespecialworkspace, music
bind = $mod, t,     togglespecialworkspace, mail
bind = $mod, q,     togglespecialworkspace, jpdb
bind = $mod, v,     togglespecialworkspace, any

bind = $mod shift, v, movetoworkspace, special:any
bind = $mod SHIFT, r, movetoworkspace, e+0

source = ~/.config/hypr/cursor.conf
